<html>
<head>
<link rel="alternate" type="application/rss+xml" title="RSS" href="http://feeds2.feedburner.com/Cprogrammingcom/">
<link rel="stylesheet" href="http://static.cprogramming.com/main_images/style.css?np9" type="text/css">
<!--[if IE]>
    <link rel="stylesheet" href="http://static.cprogramming.com/main_images/style-ie.css?np4" type="text/css">
<![endif]-->

<link href="http://static.cprogramming.com/syntax-highlight/styles/shCore.css" rel="stylesheet" type="text/css" />
<link href="http://static.cprogramming.com/syntax-highlight/styles/shThemeDefault.css" rel="stylesheet" type="text/css" />


<META NAME="keywords" CONTENT="Intel, AppUp, IntelAppUp, Development, Ultrabook, Ultrabook sensors">
<META NAME="Description" CONTENT="Learn to program UltraBook sensors on Windows 8">
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<title>Working with Ultrabook Sensors on Windows 8 - Cprogramming.com</title>

<!-- ADDED DFP -->
<script type='text/javascript' src='http://partner.googleadservices.com/gampad/google_service.js'>
</script>
<script type='text/javascript'>
GS_googleAddAdSenseService("ca-pub-2560316224908115");
GS_googleEnableAllServices();
</script>
<script type='text/javascript'>
GA_googleAddSlot("ca-pub-2560316224908115", "RunOfSite_LargeRectangle_ATF_336x280");
GA_googleAddSlot("ca-pub-2560316224908115", "RunOfSite_ATF_leaderboard_728x90");

</script>
<script type='text/javascript'>
GA_googleFetchAds();
</script>
<!-- END ADDED DFP -->


<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-7820175-1']);
  _gaq.push(['_setDomainName', '.cprogramming.com']);
  _gaq.push(['_setAllowLinker', true]);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>


</head>

<body>
<div>

<a href="http://www.cprogramming.com/"><img class="logo noprint" src="http://static.cprogramming.com/main_images/title.png" width="324" height="83" border="0"></a> 

<table class="line noprint"><tr><td></td></tr></table>
<div class="noprint" align="right" style="padding-top:25px;padding-right:25px;">
<!-- SiteSearch Google -->
<form action="http://www.google.com/cse" id="cse-search-box">
  <div>
    <input type="hidden" name="cx" value="partner-pub-2560316224908115:wqvdce-aw4a" />
    <input type="hidden" name="ie" value="ISO-8859-1" />
    <input type="text" name="q" size="31" />
    <input type="submit" name="sa" value="Search" />
  </div>
</form>
<script type="text/javascript" src="http://www.google.com/cse/brand?form=cse-search-box&amp;lang=en"></script>
<!-- SiteSearch Google -->
</div>
<div>
  <table class="main">
    <tr>

  	<td class="noprint" colspan="5" bgcolor="#EBEBEB">
  		<img src="http://static.cprogramming.com/main_images/spacer-vert.png" height="6" width="0">
  	   <center>
    	<div class="leaderboard">

<!-- ADDED DFP -->
<!-- ca-pub-2560316224908115/Homepage_ATF_leaderboard_728x90 -->
<script type='text/javascript'>
GA_googleFillSlot("RunOfSite_ATF_leaderboard_728x90");
</script>
<!-- END ADDED DFP -->

</div>
		</center>
		<img src="http://static.cprogramming.com/main_images/spacer-vert.png" height="4" width="1">
  	</td>
        
  </tr>

  <tr>

     <td class="noprint" width="130" valign="top" bgcolor="#EBEBEB"> 
     <div class="menu" valign="top" style="font-size:14px;width:200px">
     <p class="navcategory" align="left">
          <img class="bullet" src="http://static.cprogramming.com/main_images/bullet.gif" width="11" height="14">    Starting out
     </p>

     <p class="navlist" align="left" style="font-size:14px;">
             <a href="http://www.cprogramming.com/c++book/?inl=sb">Get the Ebook</a><br>
             <a href="http://www.cprogramming.com/begin.html">Get Started with C or C++</a><br>
             <a href="http://www.cprogramming.com/compilers.html">Getting a Compiler</a><br>
             <a href="http://www.cprogramming.com/books.html">Book Recommendations</a><br>
     </p>

     <p class="navcategory" align="left">
          <br>
          <img class="bullet" src="http://static.cprogramming.com/main_images/bullet.gif" width="11" height="14"> Tutorials
     </p>

     <p class="navlist" align="left" style="font-size:14px;">
            <a href=http://www.cprogramming.com/tutorial/c-tutorial.html>C Tutorial</a><br>
            <a href=http://www.cprogramming.com/tutorial/c++-tutorial.html>C++ Tutorial</a><br>
            <a href=http://www.cprogramming.com/java-programming.html>Java Tutorial</a><br>
            <a href=http://www.cprogramming.com/game-programming.html>Game Programming</a><br>
            <a href=http://www.cprogramming.com/graphics-programming.html>Graphics Programming</a><br>
            <a href=http://www.cprogramming.com/algorithms-and-data-structures.html>Algorithms &amp; Data Structures</a><br>
            <a href=http://www.cprogramming.com/debuggers.html>Debugging</a><br>
            <a href="http://www.cprogramming.com/tutorial.html">All Tutorials</a><br>
     </p>

     <p class="navcategory" align="left">
          <br>
          <img class="bullet" src="http://static.cprogramming.com/main_images/bullet.gif" width="11" height="14"> Practice
     </p>

     <p class="navlist" align="left" style="font-size:14px;">
            <a href="http://www.cprogramming.com/challenge.html">Practice Problems</a><br>
            <a href="http://www.cprogramming.com/quiz/">Quizzes</a><br>
     </p>
     <p class="navcategory" align="left">
          <br>
          <img class="bullet" src="http://static.cprogramming.com/main_images/bullet.gif" width="11" height="14"> Resources
     </p>

     <p class="navlist" align="left" style="font-size:14px;">
            <a href="http://www.cprogramming.com/cgi-bin/source/source.cgi">Source Code</a><br>
            <a href=http://www.cprogramming.com/snippets/>Source Code Snippets</a><br>
            <a href="http://www.cprogramming.com/tips/">C and C++ Tips</a><br>
            <a href=http://www.cprogramming.com/jobs/>Finding a Job</a>
     </p>

     <p class="navcategory" align="left">
          <br>
          <img class="bullet" src="http://static.cprogramming.com/main_images/bullet.gif" width="11" height="14"> References
     </p>

     <p class="navlist" align="left" style="font-size:14px;">
            <a href="http://www.cprogramming.com/function.html">Function Reference</a><br>
            <a href="http://www.cprogramming.com/reference/">Syntax Reference</a><br>
            <a href="http://www.cprogramming.com/cgi-bin/cdir/Cdirectory.cgi">Programming Links</a><br>
            <a href="http://faq.cprogramming.com/cgi-bin/smartfaq.cgi">Programming FAQ</a><br>
     </p>

     <p class="navcategory" align="left">
          <br>
          <img class="bullet" src="http://static.cprogramming.com/main_images/bullet.gif" width="11" height="14"> Getting Help
     </p>

     <p class="navlist" align="left" style="font-size:14px;">
             <a href="http://www.cprogramming.com/board.html">Message Board</a><br>
             <a href="http://www.cprogramming.com/expert.html">Ask an Expert</a><br>
             <a href="http://www.cprogramming.com/email.html">Email</a><br>
             <a href="http://www.cprogramming.com/about.html">About Us</a>
     </p>
     </div>

<center>
      <br><br>
     <script type="text/javascript"><!--
     google_ad_client = "pub-2560316224908115";
     google_ad_width = 120;
     google_ad_height = 90;
     google_ad_format = "120x90_0ads_al";
     google_ad_channel ="0800879710";
     google_color_border = "EBEBEB";
     google_color_bg = "EBEBEB";
     google_color_link = "C30000";
     google_color_url = "C30000";
     google_color_text = "000000";
     //--></script>
     <script type="text/javascript"
       src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
       </script>
</center>



    </td>
	<td class="content" valign="top">

    			<div class="content2">

<h1>Working with Ultrabook Sensors on Windows 8</h1>



<script type="text/javascript">
  function recordOutboundLink(link, category, action) {
    _gat._getTrackerByName()._trackEvent(category, action);
    setTimeout('document.location = "' + link.href + '"', 100);
  }
</script>
  <h1 id="page-title">Ultrabook and Tablet Windows 8 Sensors Development Guide</h1>
            
                        <div id="content">  <div class="region region-content">
    <div id="block-system-main" class="block block-system">
  <div class="block-inner clearfix">
                <div class="block-content content">
<i>This article is sponsored by the new <a href="http://software.intel.com" rel="nofollow" onClick="recordOutboundLink(this, 'appup9-appdeveloper', 'appup9')">Intel Developer Zone</a> and was written by Deepak Vembar</i>
    <div class="article-content">
  
<div class="field field-name-body field-type-text-with-summary field-label-hidden"><div class="field-items"><div class="field-item even" property="content:encoded"> <p><a name="intro" id="intro"></a></p>
<h2>Introduction</h2>
<p>This guide provides developers with an overview of the Microsoft Windows 8 sensors application programming interfaces (APIs) for Desktop and Windows UI style applications with a specific focus on the various sensor capabilities available in Windows 8 Desktop mode. We summarize the APIs that enable creating interactive applications by including some of the common sensors such as accelerometers, magnetometers, and gyroscopes with Windows 8.</p>
<h2>Content</h2>
<ul><li><a href="#intro" rel="nofollow">Introduction</a></li>
<li><a href="#programming-choices-for-windows" rel="nofollow">Programming Choices for Windows 8</a></li>
<li><a href="#sensors" rel="nofollow">Sensors</a>
<ul><li><a href="#sensor-fusion" rel="nofollow">Sensor Fusion</a></li>
</ul></li>
<li><a href="#identifying-sensors" rel="nofollow">Identifying Sensors</a>
<ul><li><a href="#generating-new-guids" rel="nofollow">Generating New GUIDs</a></li>
</ul></li>
<li><a href="#using-sensor-manager-object" rel="nofollow">Using Sensor Manager Object</a>
<ul><li><a href="#ask-by-type" rel="nofollow">Ask by Type</a></li>
<li><a href="#ask-by-category" rel="nofollow">Ask by Category</a></li>
<li><a href="#ask-by-category-all" rel="nofollow">Ask by Category 'All'</a></li>
</ul></li>
<li><a href="#sensor-life-cycle" rel="nofollow">Sensor Life Cycle - Enter and Leave Events</a>
<ul><li><a href="#enter-event-callback" rel="nofollow">Enter Event Callback</a></li>
<li><a href="#leave-event" rel="nofollow">Leave Event</a></li>
</ul></li>
<li><a href="#picking-sensors-for-your-app" rel="nofollow">Picking Sensors for Your App</a>
<ul><li><a href="#sensor-properties" rel="nofollow">Sensor Properties</a></li>
<li><a href="#setting-sensor-sensitivity" rel="nofollow">Setting Sensor Sensitivity</a></li>
<li><a href="#requesting-permissions" rel="nofollow">Requesting permissions for Sensors</a></li>
<li><a href="#sensor-data-update" rel="nofollow">Sensor Data Update</a></li>
</ul></li>
<li><a href="#using-sensors-in-metro-style-apps" rel="nofollow">Using Sensors in Windows UI Apps</a></li>
<li><a href="#summary" rel="nofollow">Summary</a></li>
<li><a href="#appendix" rel="nofollow">Appendix</a>
<ul><li><a href="#coordinate-system" rel="nofollow">Coordinate System for Different Form Factors</a></li>
<li><a href="#resources" rel="nofollow">Resources</a></li>
<li><a href="#about-the-author" rel="nofollow">About the Author</a></li>
</ul></li>
<li><a href="#notices" rel="nofollow">Notices</a></li>
<li><a href="#optimization-notice" rel="nofollow">Optimization Notice</a></li>
</ul><p><a name="programming-choices-for-windows" id="programming-choices-for-windows"></a></p>
<h2>Programming Choices for Windows 8</h2>
<p>Developers have multiple API choices to program sensors on Win8. The new touch-friendly app environment, called "Windows UI apps" is shown on the left in Figure 1. The only API library that Windows UI style apps can use is the completely new one called WinRT.  The WinRT sensor API represents a portion of the overall WinRT library. For more details, please refer to:  <a href="http://msdn.microsoft.com/en-us/library/windows/apps/windows.devices.sensors.aspx" onClick="recordOutboundLink(this, 'appup9-msdn1', 'appup9')" rel="nofollow">http://msdn.microsoft.com/en-us/library/windows/apps/windows.devices.sensors.aspx</a></p>
<p>Traditional Win Forms, or MFC-style apps, shown on the right, are now called "Desktop apps" because they run in the Desktop Windows Manager environment. Desktop apps can either use the native Win32/COM API or a .NET-style API.</p>
<p>In both cases, these APIs go through a Windows middleware component called the Windows Sensor Framework. The Windows Sensor Framework defines the Sensor Object Model. The different APIs "bind" to that object model in slightly different ways.</p>
<p><img src="45352-f-1.jpg" /><br />Figure 1: Windows UI and Desktop Sensor frameworks in Windows 8</p>
<p>Differences in the Desktop and Windows UI style application development will be discussed later in this document. For brevity, we will consider only Desktop app development. For Windows UI app development, please refer to <a href="http://msdn.microsoft.com/library/windows/apps/br211369" onClick="recordOutboundLink(this, 'appup9-msdn2', 'appup9')" rel="nofollow">http://msdn.microsoft.com/library/windows/apps/br211369</a></p>
<p><a name="sensors" id="sensors"></a></p>
<h2>Sensors</h2>
<p>There are many kinds of sensors, but we are interested in the ones required for Windows 8, namely accelerometers, gyroscopes, ambient light sensors, compass and GPS. Windows 8 represents the physical sensors with object-oriented abstractions. To manipulate the sensors, programmers use APIs to interact with the objects.</p>
<p>You may have noticed that there are more objects shown below (Figure 2) than actual hardware. Windows defines some "logical sensor" objects by combining information from multiple physical sensors. This is called "Sensor Fusion".</p>
<p><img src="45353-f-2.jpg" /><br />Figure 2: Different sensors supported on Windows 8</p>
<p><a name="sensor-fusion" id="sensor-fusion"></a></p>
<p><strong>Sensor Fusion</strong></p>
<p>The physical sensor chips have some inherent natural limitations. For example:</p>
<ul><li>Accelerometers measure linear acceleration, which is a measurement of the combined relative motion and the force of Earth's gravity. If you want to know the computer's tilt, you'll have to do some mathematical calculations.</li>
<li>Magnetometers measure the strength of magnetic fields, which indicate the location of the Earth's Magnetic North Pole.</li>
</ul><p>These measurements are subject to an inherent drift problem, which can be corrected by using raw data from the Gyro. Both measurements are (scaled) dependent upon the tilt of the computer from level with respect to the Earth's surface.</p>
<p>If you really want the computer's heading with respect to the Earth's True North Pole (Magnetic North Pole is in a different position and moves over time), you need to correct for that.</p>
<p>Sensor Fusion (Figure 3) is obtaining raw data from multiple physical sensors, especially the Accelerometer, Gyro, and Magnetometer, performing mathematical calculations to correct for natural sensor limitations, computing more human-usable data, and representing those as logical sensor abstractions. The application developer has to implement the necessary transformations required to translate physical sensor data to the abstract sensor data. If your system design has a SensorHub, the fusion operations will take place inside the microcontroller firmware. If your system design does not have a SensorHub, the fusion operations must be done inside one-or-more device drivers that the IHVs and/or OEMs provide.</p>
<p><img src="45355-f-3.jpg" /><br />Figure 3: Sensor fusion by combining output from multiple sensors</p>
<p><a name="identifying-sensors" id="identifying-sensors"></a></p>
<h2>Identifying Sensors</h2>
<p>To manipulate a sensor, you need a system to identify and refer to it. The Windows Sensor Framework defines a number of categories that sensors are grouped into. It also defines a large number of specific sensor types. Table 1 lists some of the sensors available for your Desktop application.</p>
<p align="center">Table 1: Sensor types and categories</p>
<table class="table-blue-themed-fixed-width"><thead><tr><td colspan="9"><strong>.All.</strong></td>
</tr><tr><th><strong>Biometric</strong></th><th><strong>Electrical</strong></th><th><strong>Environmental</strong></th><th><strong>Light</strong></th><th><strong>Location</strong></th><th><strong>Mechanical</strong></th><th><strong>Motion</strong></th><th><strong>Orientation</strong></th><th><strong>Scanner</strong></th></tr></thead><tbody><tr><td>Human Presence</td>
<td>Capacitance</td>
<td>Atmospheric Pressure</td>
<td><strong>Ambient Light</strong></td>
<td>Broadcast</td>
<td>Boolean Switch</td>
<td>Accelerometer 1D</td>
<td>Compass 1D</td>
<td>Barcode</td>
</tr><tr><td>Human Proximity*</td>
<td>Current</td>
<td>Humidity</td>
<td></td>
<td><strong>Gps*</strong></td>
<td>Boolean Switch Array</td>
<td>Accelerometer 2D</td>
<td>Compass 2D</td>
<td>Rfid</td>
</tr><tr><td>Touch</td>
<td>Electrical Power</td>
<td>Temperature</td>
<td></td>
<td>Static</td>
<td>Force</td>
<td><strong>Accelerometer 3D</strong></td>
<td><strong>Compass 3D</strong></td>
<td></td>
</tr><tr><td></td>
<td>Inductance</td>
<td>Wind Direction</td>
<td></td>
<td></td>
<td>Multivalue Switch</td>
<td>Gyrometer 1D</td>
<td><strong>Device Orientation*</strong></td>
<td></td>
</tr><tr><td></td>
<td>Potentio-meter</td>
<td>Wind Speed</td>
<td></td>
<td></td>
<td>Pressure</td>
<td>Gyrometer 2D</td>
<td>Distance 1D</td>
<td></td>
</tr><tr><td></td>
<td>Resistance</td>
<td></td>
<td></td>
<td></td>
<td>Strain</td>
<td><strong>Gyrometer 3D</strong></td>
<td>Distance 2D</td>
<td></td>
</tr><tr><td></td>
<td>Voltage</td>
<td></td>
<td></td>
<td></td>
<td>Weight</td>
<td>Motion Detector</td>
<td>Distance 3D</td>
<td></td>
</tr><tr><td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>Speedometer</td>
<td>Inclinometer 1D</td>
<td></td>
</tr><tr><td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td>Inclinometer 2D</td>
<td></td>
</tr><tr><td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td><strong>Inclinometer 3D*</strong></td>
<td></td>
</tr></tbody></table><p></p>
<p>The sensor types required by Windows 8 are shown in <strong>bold*</strong> font:</p>
<ul><li>Accelerometer, Gyro, Compass, and Ambient Light are the required "real/physical" sensors</li>
<li>Device Orientation and Inclinometer are the required "virtual/fusion" sensors (note that the Compass also includes fusion-enhanced/tilt-compensated data)</li>
<li>GPS is a required sensor if you have a WWAN radio, otherwise GPS is optional</li>
<li>Human Proximity is an oft-mentioned possible addition to the required list, but, for now, it's not required.</li>
</ul><p>The names of the categories and types shown in Table 1 are nice, human-readable forms. However, for programming, you'll need to know the programming constants for each type of sensor. All of these constants are actually just numbers called GUIDs (Globally Unique IDs). Below, in Table 2, is a sample of some of the sensor categories and types, the names of the constants for Win32/COM and .NET, and their underlying GUID values.</p>
<p align="center">Table 2: Constants and unique Globally Unique IDs (GUIDs) for some common sensors</p>
<table class="table-blue-themed-fixed-width"><thead><tr><th><strong>Identifier</strong></th><th><strong>Constant (Win32/COM)</strong></th><th><strong>Constant (.NET)</strong></th><th><strong>GUID</strong></th></tr></thead><tbody><tr><td>Category .All.</td>
<td>SENSOR_CATEGORY_ALL</td>
<td>SensorCategories.SensorCategoryAll</td>
<td>{C317C286-C468-4288-9975-D4C4587C442C}</td>
</tr><tr><td>Category Biometric</td>
<td>SENSOR_CATEGORY_BIOMETRIC</td>
<td>SensorCategories.SensorCategoryBiometric</td>
<td>{CA19690F-A2C7-477D-A99E-99EC6E2B5648}</td>
</tr><tr><td>Category Electrical</td>
<td>SENSOR_CATEGORY_ELECTRICAL</td>
<td>SensorCategories.SensorCategoryElectrical</td>
<td>{FB73FCD8-FC4A-483C-AC58-27B691C6BEFF}</td>
</tr><tr><td>Category Environmental</td>
<td>SENSOR_CATEGORY_ENVIRONMENTAL</td>
<td>SensorCategories.SensorCategoryEnvironmental</td>
<td>{323439AA-7F66-492B-BA0C-73E9AA0A65D5}</td>
</tr><tr><td>Category Light</td>
<td>SENSOR_CATEGORY_LIGHT</td>
<td>SensorCategories.SensorCategoryLight</td>
<td>{17A665C0-9063-4216-B202-5C7A255E18CE}</td>
</tr><tr><td>Category Location</td>
<td>SENSOR_CATEGORY_LOCATION</td>
<td>SensorCategories.SensorCategoryLocation</td>
<td>{BFA794E4-F964-4FDB-90F6-51056BFE4B44}</td>
</tr><tr><td>Category Mechanical</td>
<td>SENSOR_CATEGORY_MECHANICAL</td>
<td>SensorCategories.SensorCategoryMechanical</td>
<td>{8D131D68-8EF7-4656-80B5-CCCBD93791C5}</td>
</tr><tr><td>Category Motion</td>
<td>SENSOR_CATEGORY_MOTION</td>
<td>SensorCategories.SensorCategoryMotion</td>
<td>{CD09DAF1-3B2E-4C3D-B598-B5E5FF93FD46}</td>
</tr><tr><td>Category Orientation</td>
<td>SENSOR_CATEGORY_ORIENTATION</td>
<td>SensorCategories.SensorCategoryOrientation</td>
<td>{9E6C04B6-96FE-4954-B726-68682A473F69}</td>
</tr><tr><td>Category Scanner</td>
<td>SENSOR_CATEGORY_SCANNER</td>
<td>SensorCategories.SensorCategoryScanner</td>
<td>{B000E77E-F5B5-420F-815D-0270ª726F270}</td>
</tr><tr><td>Type HumanProximity</td>
<td>SENSOR_TYPE_HUMAN_PROXIMITY</td>
<td>SensorTypes.SensorTypeHumanProximity</td>
<td>{5220DAE9-3179-4430-9F90-06266D2A34DE}</td>
</tr><tr><td>Type AmbientLight</td>
<td>SENSOR_TYPE_AMBIENT_LIGHT</td>
<td>SensorTypes.SensorTypeAmbientLight</td>
<td>{97F115C8-599A-4153-8894-D2D12899918A}</td>
</tr><tr><td>Type Gps</td>
<td>SENSOR_TYPE_LOCATION_GPS</td>
<td>SensorTypes.SensorTypeLocationGps</td>
<td>{ED4CA589-327A-4FF9-A560-91DA4B48275E}</td>
</tr><tr><td>Type Accelerometer3D</td>
<td>SENSOR_TYPE_ACCELEROMETER_3D</td>
<td>SensorTypes.SensorTypeAccelerometer3D</td>
<td>{C2FB0F5F-E2D2-4C78-BCD0-352A9582819D}</td>
</tr><tr><td>Type Gyrometer3D</td>
<td>SENSOR_TYPE_GYROMETER_3D</td>
<td>SensorTypes.SensorTypeGyrometer3D</td>
<td>{09485F5A-759E-42C2-BD4B-A349B75C8643}</td>
</tr><tr><td>Type Compass3D</td>
<td>SENSOR_TYPE_COMPASS_3D</td>
<td>SensorTypes.SensorTypeCompass3D</td>
<td>{76B5CE0D-17DD-414D-93A1-E127F40BDF6E}</td>
</tr><tr><td>Type Compass3D</td>
<td>SENSOR_TYPE_COMPASS_3D</td>
<td>SensorTypes.SensorTypeCompass3D</td>
<td>{76B5CE0D-17DD-414D-93A1-E127F40BDF6E}</td>
</tr><tr><td>Type DeviceOrientation</td>
<td>SENSOR_TYPE_DEVICE_ORIENTATION</td>
<td>SensorTypes.SensorTypeDeviceOrientation</td>
<td>{CDB5D8F7-3CFD-41C8-8542-CCE622CF5D6E}</td>
</tr><tr><td>Type Inclinometer3D</td>
<td>SENSOR_TYPE_INCLINOMETER_3D</td>
<td>SensorTypes.SensorTypeInclinometer3D</td>
<td>{B84919FB-EA85-4976-8444-6F6F5C6D31DB}</td>
</tr></tbody></table><p>These are the most commonly used GUIDs-there are many more you can explore. At first you might think that the GUIDs are silly and tedious, but there is one good reason for using them: extensibility. Since the APIs don't care about the actual sensor names (they just pass GUIDs around), it is possible for vendors to invent new GUIDs for "value add" sensors.</p>
<p><a name="generating-new-guids" id="generating-new-guids"></a></p>
<p><strong>Generating New GUIDs</strong></p>
<p>Microsoft provides a tool in Visual Studio that allows anyone to generate new GUIDs. Figure 4 shows a screenshot from Visual Studio for doing this. All the vendor has to do is publish them, and new functionality can be exposed <strong><em>without</em></strong> the need to change the Microsoft APIs or any operating system code at all.</p>
<p><img src="45356-f-4.jpg" /><br />Figure 4: Defining new GUIDs for value add sensors</p>
<p><a name="using-sensor-manager-object" id="using-sensor-manager-object"></a></p>
<h2>Using Sensor Manager Object</h2>
<p><a name="ask-by-type" id="ask-by-type"></a></p>
<p><strong>Ask by Type</strong></p>
<p>Your app can ask for a specific type of sensor, such as Gyrometer3D. The Sensor Manager consults the list of sensor hardware present on the computer and returns a collection of matching objects bound to that hardware. Although the Sensor Collection may have 0, 1, or more objects, it usually has only one. Below is a C++ code sample illustrating the use of the Sensor Manager object's <em>GetSensorsByType</em> method to search for 3-axis Gyros and return them in a Sensor Collection. Note that you have to ::CoCreateInstance() the Sensor Manager Object first.</p>
<pre class="brush: cpp">// Additional includes for sensors
#include &lt;InitGuid.h&gt;
#include &lt;SensorsApi.h&gt;
#include &lt;Sensors.h&gt;
// Create a COM interface to the SensorManager object.
ISensorManager* pSensorManager = NULL;
HRESULT hr = ::CoCreateInstance(CLSID_SensorManager, NULL, CLSCTX_INPROC_SERVER, 
    IID_PPV_ARGS(&amp;pSensorManager));
if (FAILED(hr))
{
    ::MessageBox(NULL, _T("Unable to CoCreateInstance() the SensorManager."), 
        _T("Sensor C++ Sample"), MB_OK | MB_ICONERROR);
    return -1;
}
// Get a collection of all motion sensors on the computer.
ISensorCollection* pSensorCollection = NULL;
hr = pSensorManager-&gt;GetSensorsByType(SENSOR_TYPE_GYROMETER_3D, &amp;pSensorCollection);
if (FAILED(hr))
{
    ::MessageBox(NULL, _T("Unable to find any Gyros on the computer."), 
        _T("Sensor C++ Sample"), MB_OK | MB_ICONERROR);
    return -1;
}
</pre>
<p><a name="ask-by-category" id="ask-by-category"></a></p>
<p><strong>Ask by Category</strong></p>
<p>Your app can ask for sensors by category, such as all motion sensors. The Sensor Manager consults the list of sensor hardware on the computer and returns a collection of motion objects bound to that hardware. The SensorCollection may have 0, 1, or more objects in it. On most computers, the collection will have two motion objects: Accelerometer3D and Gyrometer3D.</p>
<p>The C++ code sample below illustrates the use of the Sensor Manager object's <em>GetSensorsByCategory</em> method to search for motion sensors and return them in a sensor collection.</p>
<pre class="brush: cpp">
// Additional includes for sensors
#include &lt;InitGuid.h&gt;
#include &lt;SensorsApi.h&gt;
#include &lt;Sensors.h&gt;
// Create a COM interface to the SensorManager object. 
ISensorManager* pSensorManager = NULL; 
HRESULT hr = ::CoCreateInstance(CLSID_SensorManager, NULL, CLSCTX_INPROC_SERVER, IID_PPV_ARGS(&amp;pSensorManager));
if (FAILED(hr)) { 
    ::MessageBox(NULL, _T("Unable to CoCreateInstance() the SensorManager."), _T("Sensor C++ Sample"), MB_OK | MB_ICONERROR);
    return -1; 
} 
// Get a collection of all motion sensors on the computer. 
ISensorCollection* pSensorCollection = NULL;
hr = pSensorManager-&gt;GetSensorsByCategory(SENSOR_CATEGORY_MOTION, &amp;pSensorCollection);
if (FAILED(hr)) {
    ::MessageBox(NULL, _T("Unable to find any Motion sensors on the computer."), _T("Sensor C++ Sample"), MB_OK | MB_ICONERROR);
    return -1; 
} </pre>
<p><a name="ask-by-category-all" id="ask-by-category-all"></a></p>
<p><strong>Ask by Category "All"</strong></p>
<p>In practice, the most efficient way is for your app to ask for all of the sensors on the computer. The Sensor Manager consults the list of sensor hardware on the computer and returns a collection of all the objects bound to that hardware. The Sensor Collection may have 0, 1, or more objects in it. On most computers, the collection will have seven or more objects.</p>
<p>C++ does not have a <em>GetAllSensors</em> call, so you must use <em>GetSensorsByCategory(SENSOR_CATEGORY_ALL, .)</em> instead as shown in the sample code below.</p>
<pre class="brush: cpp">
// Additional includes for sensors
#include &lt;InitGuid.h&gt;
#include &lt;SensorsApi.h&gt;
#include &lt;Sensors.h&gt;
// Create a COM interface to the SensorManager object. ISensorManager* pSensorManager = NULL;
HRESULT hr = ::CoCreateInstance(CLSID_SensorManager, NULL, CLSCTX_INPROC_SERVER, IID_PPV_ARGS(&amp;pSensorManager));
if (FAILED(hr)) { 
    ::MessageBox(NULL, _T("Unable to CoCreateInstance() the SensorManager."), _T("Sensor C++ Sample"), MB_OK | MB_ICONERROR);
    return -1; 
} 
// Get a collection of all sensors on the computer. 
ISensorCollection* pSensorCollection = NULL;
hr = pSensorManager-&gt;GetSensorsByCategory(SENSOR_CATEGORY_ALL, &amp;pSensorCollection);
if (FAILED(hr)) { 
    ::MessageBox(NULL, _T("Unable to find any sensors on the computer."), _T("Sensor C++ Sample"), MB_OK | MB_ICONERROR);
    return -1; 
} </pre>
<p><a name="sensor-life-cycle" id="sensor-life-cycle"></a></p>
<h2>Sensor Life Cycle - Enter and Leave Events</h2>
<p>On Windows, as with most hardware devices, sensors are treated as Plug and Play devices. At first you might say, "The sensors are hard-wired on the computer's motherboard, why do we have to worry about Plug and Play if they'll never be plugged in or unplugged?" There are a few different scenarios where it occurs:</p>
<p>1. It is possible to have USB-based sensors external to the system and plugged into a USB port.</p>
<p>2. It is conceivable to have sensors that are attached by an unreliable wireless interface (such as Bluetooth) or wired interface (such as Ethernet), where connects and disconnects happen.</p>
<p>3. If and when Windows Update upgrades the device driver for the sensors, they appear to disconnect and then reconnect.</p>
<p>4. When Windows shuts down (to S4 or S5), the sensors appear to disconnect.</p>
<p>In the context of sensors, a Plug and Play connect is called an <strong>Enter</strong> event, and disconnect is called a <strong>Leave</strong> event. Resilient apps need to be able to handle both.</p>
<p><a name="enter-event-callback" id="enter-event-callback"></a></p>
<p><strong>Enter Event Callback</strong></p>
<p>Your app may already be running at the time a sensor is plugged in. When this happens, the Sensor Manager reports the sensor Enter event. Note: if the sensors are already plugged in when your app starts running, you will not get Enter events for those sensors. In C++/COM, you must use the <em>SetEventSink</em> method to hook the callback. The callback cannot simply be a function, it must be an entire class that inherits from <em>ISensorManagerEvents</em>, and also implements <em>IUnknown</em>. The <em>ISensorManagerEvents</em> interface must have callback function implementations for:</p>
<p align="center">STDMETHODIMP OnSensorEnter(ISensor *pSensor, SensorState state);</p>
<pre class="brush: cpp">// Hook the SensorManager for any SensorEnter events.
pSensorManagerEventClass = new SensorManagerEventSink();  // create C++ class instance
// get the ISensorManagerEvents COM interface pointer
HRESULT hr = pSensorManagerEventClass-&gt;QueryInterface(IID_PPV_ARGS(&amp;pSensorManagerEvents)); 
if (FAILED(hr))
{
    ::MessageBox(NULL, _T("Cannot query ISensorManagerEvents interface for our callback class."), 
        _T("Sensor C++ Sample"), MB_OK | MB_ICONERROR);
    return -1;
}
// hook COM interface of our class to SensorManager eventer
hr = pSensorManager-&gt;SetEventSink(pSensorManagerEvents); 
if (FAILED(hr))
{
    ::MessageBox(NULL, _T("Cannot SetEventSink on SensorManager to our callback class."), 
        _T("Sensor C++ Sample"), MB_OK | MB_ICONERROR);
    return -1;
}
</pre>
<p><strong>Code: Hook Callback for Enter event</strong></p>
<p>Below is the C++/COM equivalent of the Enter callback. You would normally perform all the initialization steps from your main loop in this function. In fact, it is more efficient to refactor your code so your main loop merely calls <em>OnSensorEnter</em> to simulate an Enter event.</p>
<pre class="brush: cpp">STDMETHODIMP SensorManagerEventSink::OnSensorEnter(ISensor *pSensor, SensorState state)
{
    // Examine the SupportsDataField for SENSOR_DATA_TYPE_LIGHT_LEVEL_LUX.
    VARIANT_BOOL bSupported = VARIANT_FALSE;
    HRESULT hr = pSensor-&gt;SupportsDataField(SENSOR_DATA_TYPE_LIGHT_LEVEL_LUX, &amp;bSupported);
    if (FAILED(hr))
    {
        ::MessageBox(NULL, _T("Cannot check SupportsDataField for SENSOR_DATA_TYPE_LIGHT_LEVEL_LUX."), 
            _T("Sensor C++ Sample"), MB_OK | MB_ICONINFORMATION);
        return hr;
    }
    if (bSupported == VARIANT_FALSE)
    {
        // This is not the sensor we want.
        return -1;
    }
    ISensor *pAls = pSensor;  // It looks like an ALS, memorize it. 
    ::MessageBox(NULL, _T("Ambient Light Sensor has entered."), 
        _T("Sensor C++ Sample"), MB_OK | MB_ICONINFORMATION);
    .
    .
    .
    return hr;
}
</pre>
<p><strong>Code: Callback for Enter event </strong></p>
<p><a name="leave-event" id="leave-event"></a></p>
<p><strong>Leave Event</strong></p>
<p>The individual sensor reports when the Leave event happens (not the Sensor Manager). This code is actually the same as the previous hook callback for an Enter event.</p>
<pre class="brush: cpp">// Hook the Sensor for any DataUpdated, Leave, or StateChanged events.
SensorEventSink* pSensorEventClass = new SensorEventSink();  // create C++ class instance
ISensorEvents* pSensorEvents = NULL;
// get the ISensorEvents COM interface pointer
HRESULT hr = pSensorEventClass-&gt;QueryInterface(IID_PPV_ARGS(&amp;pSensorEvents)); 
if (FAILED(hr))
{
    ::MessageBox(NULL, _T("Cannot query ISensorEvents interface for our callback class."), 
        _T("Sensor C++ Sample"), MB_OK | MB_ICONERROR);
    return -1;
}
hr = pSensor-&gt;SetEventSink(pSensorEvents); // hook COM interface of our class to Sensor eventer
if (FAILED(hr))
{
    ::MessageBox(NULL, _T("Cannot SetEventSink on the Sensor to our callback class."), 
        _T("Sensor C++ Sample"), MB_OK | MB_ICONERROR);
    return -1;
}
</pre>
<p><strong>Code: Hook Callback for Leave event </strong></p>
<p>The <em>OnLeave</em> event handler receives the ID of the leaving sensor as an argument.</p>
<pre class="brush: cpp">STDMETHODIMP SensorEventSink::OnLeave(REFSENSOR_ID sensorID)
{
    HRESULT hr = S_OK;
    ::MessageBox(NULL, _T("Ambient Light Sensor has left."), 
        _T("Sensor C++ Sample"), MB_OK | MB_ICONINFORMATION);
    // Perform any housekeeping tasks for the sensor that is leaving.
    // For example, if you have maintained a reference to the sensor,
    // release it now and set the pointer to NULL.
    return hr;
}
</pre>
<p><strong>Code: Callback for Leave event </strong></p>
<p><a name="picking-sensors-for-your-app" id="picking-sensors-for-your-app"></a></p>
<h2>Picking Sensors for Your App</h2>
<p>We care about sensors because of what they tell us. Different types of sensors tell us different things. Microsoft calls these pieces of information <strong>Data Fields</strong>, and they are grouped together in a SensorDataReport. Your computer may (potentially) have more than one type of sensor that can tell your app the information you care about. Your app probably doesn't care which sensor it gets the information from, so long as it can get it.</p>
<p>Table 3 shows the constant names for the most commonly used Data Fields for Win32/COM and.NET. Just like sensor identifiers, these constants are just human-readable names for what are really just big numbers underneath. This provides for extensibility of Data Fields beyond the "well known" ones Microsoft has pre-defined. There are many other "well known" IDs for you to explore.</p>
<p align="center">Table 3: Data Field identifier constants</p>
<table class="table-blue-themed-fixed-width"><thead><tr><th><strong>Constant (Win32/COM)</strong></th><th><strong>Constant (.NET)</strong></th><th><strong>PROPERTYKEY (GUID,PID)</strong></th></tr></thead><tbody><tr><td>SENSOR_DATA_TYPE_TIMESTAMP</td>
<td>SensorDataTypeTimestamp</td>
<td>{DB5E0CF2-CF1F-4C18-B46C-D86011D62150},2</td>
</tr><tr><td>SENSOR_DATA_TYPE_LIGHT_LEVEL_LUX</td>
<td>SensorDataTypeLightLevelLux</td>
<td>{E4C77CE2-DCB7-46E9-8439-4FEC548833A6},2</td>
</tr><tr><td>SENSOR_DATA_TYPE_ACCELERATION_X_G</td>
<td>SensorDataTypeAccelerationXG</td>
<td>{3F8A69A2-07C5-4E48-A965-CD797AAB56D5},2</td>
</tr><tr><td>SENSOR_DATA_TYPE_ACCELERATION_Y_G</td>
<td>SensorDataTypeAccelerationYG</td>
<td>{3F8A69A2-07C5-4E48-A965-CD797AAB56D5},3</td>
</tr><tr><td>SENSOR_DATA_TYPE_ACCELERATION_Z_G</td>
<td>SensorDataTypeAccelerationZG</td>
<td>{3F8A69A2-07C5-4E48-A965-CD797AAB56D5},4</td>
</tr><tr><td>SENSOR_DATA_TYPE_ANGULAR_VELOCITY_X_DEG<br />REES_PER_SECOND</td>
<td>SensorDataTypeAngularVelocityXDegreesPerSecond</td>
<td>{3F8A69A2-07C5-4E48-A965-CD797AAB56D5},10</td>
</tr><tr><td>SENSOR_DATA_TYPE_ANGULAR_VELOCITY_X_DE<br />GREES_PER_SECOND</td>
<td>SensorDataTypeAngularVelocityXDegreesPerSecond</td>
<td>{3F8A69A2-07C5-4E48-A965-CD797AAB56D5},10</td>
</tr><tr><td>SENSOR_DATA_TYPE_ANGULAR_VELOCITY_Y_DE<br />GREES_PER_SECOND</td>
<td>SensorDataTypeAngularVelocityYDegreesPerSecond</td>
<td>{3F8A69A2-07C5-4E48-A965-CD797AAB56D5},11</td>
</tr><tr><td>SENSOR_DATA_TYPE_ANGULAR_VELOCITY_Y_DE<br />GREES_PER_SECOND</td>
<td>SensorDataTypeAngularVelocityYDegreesPerSecond</td>
<td>{3F8A69A2-07C5-4E48-A965-CD797AAB56D5},11</td>
</tr><tr><td>SENSOR_DATA_TYPE_ANGULAR_VELOCITY_Z_DE<br />GREES_PER_SECOND</td>
<td>SensorDataTypeAngularVelocityZDegreesPerSecond</td>
<td>{3F8A69A2-07C5-4E48-A965-CD797AAB56D5},12</td>
</tr><tr><td>SENSOR_DATA_TYPE_TILT_X_DEGREES</td>
<td>SensorDataTypeTiltXDegrees</td>
<td>{1637D8A2-4248-4275-865D-558DE84AEDFD},2</td>
</tr><tr><td>SENSOR_DATA_TYPE_TILT_Y_DEGREES</td>
<td>SensorDataTypeTiltYDegrees</td>
<td>{1637D8A2-4248-4275-865D-558DE84AEDFD},3</td>
</tr><tr><td>SENSOR_DATA_TYPE_TILT_Z_DEGREES</td>
<td>SensorDataTypeTiltZDegrees</td>
<td>{1637D8A2-4248-4275-865D-558DE84AEDFD},4</td>
</tr><tr><td>SENSOR_DATA_TYPE_MAGNETIC_HEADING_COM<br />PENSATED_MAGNETIC_NORTH_DEGREES</td>
<td>SensorDataTypeMagneticHeadingCompensated<br />TrueNorthDegrees</td>
<td>{1637D8A2-4248-4275-865D-558DE84AEDFD},11</td>
</tr><tr><td>SENSOR_DATA_TYPE_MAGNETIC_FIELD_STRENGTH<br />_X_MILLIGAUSS</td>
<td>SensorDataTypeMagneticFieldStrengthXMilligauss</td>
<td>{1637D8A2-4248-4275-865D-558DE84AEDFD},19</td>
</tr><tr><td>SENSOR_DATA_TYPE_MAGNETIC_FIELD_STRENGTH<br />_Y_MILLIGAUSS</td>
<td>SensorDataTypeMagneticFieldStrengthYMilligauss</td>
<td>{1637D8A2-4248-4275-865D-558DE84AEDFD},20</td>
</tr><tr><td>SENSOR_DATA_TYPE_MAGNETIC_FIELD_STRENGTH<br />_Z_MILLIGAUSS</td>
<td>SensorDataTypeMagneticFieldStrengthZMilligauss</td>
<td>{1637D8A2-4248-4275-865D-558DE84AEDFD},21</td>
</tr><tr><td>SENSOR_DATA_TYPE_QUATERNION</td>
<td>SensorDataTypeQuaternion</td>
<td>{1637D8A2-4248-4275-865D-558DE84AEDFD},17</td>
</tr><tr><td>SENSOR_DATA_TYPE_QUATERNION</td>
<td>SensorDataTypeQuaternion</td>
<td>{1637D8A2-4248-4275-865D-558DE84AEDFD},17</td>
</tr><tr><td>SENSOR_DATA_TYPE_ROTATION_MATRIX</td>
<td>SensorDataTypeRotationMatrix</td>
<td>{1637D8A2-4248-4275-865D-558DE84AEDFD},16</td>
</tr><tr><td>SENSOR_DATA_TYPE_LATITUDE_DEGREES</td>
<td>SensorDataTypeLatitudeDegrees</td>
<td>{055C74D8-CA6F-47D6-95C6-1ED3637A0FF4},2</td>
</tr><tr><td>SENSOR_DATA_TYPE_LONGITUDE_DEGREES</td>
<td>SensorDataTypeLongitudeDegrees</td>
<td>{055C74D8-CA6F-47D6-95C6-1ED3637A0FF4},3</td>
</tr><tr><td>SENSOR_DATA_TYPE_ALTITUDE_ELLIPSOID_METERS</td>
<td>SensorDataTypeAltitudeEllipsoidMeters</td>
<td>{055C74D8-CA6F-47D6-95C6-1ED3637A0FF4},5</td>
</tr></tbody></table><p></p>
<p>One thing that makes Data Field identifiers different from sensor IDs is the use of a data type called PROPERTYKEY. A PROPERTYKEY consists of a GUID (similar to what sensors have), plus an extra number called a "PID" (property ID). You might notice that the GUID part of a PROPERTYKEY is common for sensors that are in the same category. Data Fields have a native data type for all of their values, such as Boolean, unsigned char, int, float, double, and so on.</p>
<p>In Win32/COM, the value of a Data Field is stored in a polymorphic data type called PROPVARIANT. In .NET, there is a CLR (Common Language Runtime) data type called .object. that does the same thing. You have to query and/or typecast the polymorphic data type to the "expected"/"documented" data type.</p>
<p>Use the <em>SupportsDataField()</em> method of the sensor to check the sensors for the Data Fields of interest. This is the most common programming idiom that we use to select sensors. Depending on the usage model of your app, you may only need a subset of the Data Fields, not all of them. Pick the sensors you want based on whether they support the Data Fields you need. Note that you also need to use type casting to assign the sub-classed member variables from the base class sensor.</p>
<pre class="brush: cpp">ISensor* m_pAls;
ISensor* m_pAccel;
ISensor* m_pTilt;
// Cycle through the collection looking for sensors we care about.
ULONG ulCount = 0;
HRESULT hr = pSensorCollection-&gt;GetCount(&amp;ulCount);
if (FAILED(hr))
{
    ::MessageBox(NULL, _T("Unable to get count of sensors on the computer."), _T("Sensor C++ Sample"), MB_OK | MB_ICONERROR);
    return -1;
}
for (int i = 0; i &lt; (int)ulCount; i++)
{
    hr = pSensorCollection-&gt;GetAt(i, &amp;pSensor);
    if (SUCCEEDED(hr))
    {
        VARIANT_BOOL bSupported = VARIANT_FALSE;
        hr = pSensor-&gt;SupportsDataField(SENSOR_DATA_TYPE_LIGHT_LEVEL_LUX, &amp;bSupported);
        if (SUCCEEDED(hr) &amp;&amp; (bSupported == VARIANT_TRUE)) m_pAls = pSensor;
        hr = pSensor-&gt;SupportsDataField(SENSOR_DATA_TYPE_ACCELERATION_Z_G, &amp;bSupported);
        if (SUCCEEDED(hr) &amp;&amp; (bSupported == VARIANT_TRUE)) m_pAccel = pSensor;
        hr = pSensor-&gt;SupportsDataField(SENSOR_DATA_TYPE_TILT_Z_DEGREES, &amp;bSupported);
        if (SUCCEEDED(hr) &amp;&amp; (bSupported == VARIANT_TRUE)) m_pTilt = pSensor;
        .
        .
        .
    }
}
</pre>
<p><strong>Code: Use the SupportsDataField() method of the sensor to check for supported data field</strong></p>
<p><a name="sensor-properties" id="sensor-properties"></a></p>
<p><strong>Sensor Properties</strong></p>
<p>In addition to Data Fields, sensors have <strong>Properties</strong> that can be used for identification and configuration. Table 4 shows the most commonly-used Properties. Just like Data Fields, Properties have constant names used by Win32/COM and .NET, and those constants are really PROPERTYKEY numbers underneath. Properties are extensible by vendors and also have PROPVARIANT polymorphic data types. Unlike Data Fields that are read-only, Properties have the <strong>ability</strong> to be Read/Write. It is up to the individual sensor's discretion as to whether or not it rejects Write attempts. As an app developer, you need to perform write-read-verify because no exception is thrown when a write attempt fails.</p>
<p align="center">Table 4: Commonly used sensor Properties and PIDs</p>
<table class="table-blue-themed-fixed-width"><thead><tr><th><strong>Identification(Win32/COM)</strong></th><th><strong>Identification(.NET)</strong></th><th><strong>PROPERTYKEY (GUID,PID)</strong></th></tr></thead><tbody><tr><td>SENSOR_PROPERTY_PERSISTENT_UNIQUE_ID</td>
<td>SensorID</td>
<td>{7F8383EC-D3EC-495C-A8CF-B8BBE85C2920},5</td>
</tr><tr><td>WPD_FUNCTIONAL_OBJECT_CATEGORY</td>
<td>CategoryID</td>
<td>{8F052D93-ABCA-4FC5-A5AC-B01DF4DBE598},2</td>
</tr><tr><td>SENSOR_PROPERTY_TYPE</td>
<td>TypeID</td>
<td>{7F8383EC-D3EC-495C-A8CF-B8BBE85C2920},2</td>
</tr><tr><td>SENSOR_PROPERTY_STATE</td>
<td>State</td>
<td>{7F8383EC-D3EC-495C-A8CF-B8BBE85C2920},3</td>
</tr><tr><td>SENSOR_PROPERTY_MANUFACTURER</td>
<td>SensorManufacturer</td>
<td>7F8383EC-D3EC-495C-A8CF-B8BBE85C2920},6</td>
</tr><tr><td>SENSOR_PROPERTY_MODEL</td>
<td>SensorModel</td>
<td>{7F8383EC-D3EC-495C-A8CF-B8BBE85C2920},7</td>
</tr><tr><td>SENSOR_PROPERTY_SERIAL_NUMBER</td>
<td>SensorSerialNumber</td>
<td>(7F8383EC-D3EC-495C-A8CF-B8BBE85C2920},8</td>
</tr><tr><td>SENSOR_PROPERTY_FRIENDLY_NAME</td>
<td>FriendlyName</td>
<td>{7F8383EC-D3EC-495C-A8CF-B8BBE85C2920},9</td>
</tr><tr><td>SENSOR_PROPERTY_DESCRIPTION</td>
<td>SensorDescription</td>
<td>{7F8383EC-D3EC-495C-A8CF-B8BBE85C2920},10</td>
</tr><tr><td>SENSOR_PROPERTY_MIN_REPORT_INTERVAL</td>
<td>MinReportInterval</td>
<td>{7F8383EC-D3EC-495C-A8CF-B8BBE85C2920},12</td>
</tr><tr><td>SENSOR_PROPERTY_CONNECTION_TYPE</td>
<td>SensorConnectionType</td>
<td>{7F8383EC-D3EC-495C-A8CF-B8BBE85C2920},11</td>
</tr><tr><td>SENSOR_PROPERTY_DEVICE_ID</td>
<td>SensorDevicePath</td>
<td>{7F8383EC-D3EC-495C-A8CF-B8BBE85C2920},15</td>
</tr><tr><td>SENSOR_PROPERTY_RANGE_MAXIMUM</td>
<td>SensorRangeMaximum</td>
<td>{7F8383EC-D3EC-495C-A8CF-B8BBE85C2920},21</td>
</tr><tr><td>SENSOR_PROPERTY_RANGE_MINIMUM</td>
<td>SensorRangeMinimum</td>
<td>{7F8383EC-D3EC-495C-A8CF-B8BBE85C2920},20</td>
</tr><tr><td>SENSOR_PROPERTY_ACCURACY</td>
<td>SensorAccuracy</td>
<td>{7F8383EC-D3EC-495C-A8CF-B8BBE85C2920},17</td>
</tr><tr><td>SENSOR_PROPERTY_RESOLUTION</td>
<td>SensorResolution</td>
<td>{7F8383EC-D3EC-495C-A8CF-B8BBE85C2920},18</td>
</tr></tbody></table><p><br /><br /></p>
<table class="table-blue-themed-fixed-width"><thead><tr><th><strong>Configuration(Win32/COM)</strong></th><th><strong>Configuration(.NET)</strong></th><th><strong>PROPERTYKEY (GUID,PID)</strong></th></tr></thead><tbody><tr><td>SENSOR_PROPERTY_CURRENT_REPORT_INTERVAL</td>
<td>ReportInterval</td>
<td>{7F8383EC-D3EC-495C-A8CF-B8BBE85C2920},13</td>
</tr><tr><td>SENSOR_PROPERTY_CHANGE_SENSITIVITY</td>
<td>ChangeSensitivity</td>
<td>{7F8383EC-D3EC-495C-A8CF-B8BBE85C2920},14</td>
</tr><tr><td>SENSOR_PROPERTY_REPORTING_STATE</td>
<td>ReportingState</td>
<td>{7F8383EC-D3EC-495C-A8CF-B8BBE85C2920},27</td>
</tr></tbody></table><p><br /><a name="setting-sensor-sensitivity" id="setting-sensor-sensitivity"></a></p>
<p><strong>Setting Sensor Sensitivity</strong></p>
<p>The sensitivity setting is probably the most useful Property of a sensor. It can be used to assign a threshold that controls or filters the number of SensorDataReports sent to the host computer. In this way, traffic can be reduced: only send up those DataUpdated events that are truly worthy of bothering the host CPU. The way Microsoft has defined the data type of this Sensitivity property is a little unusual. It is a container type called IPortableDeviceValues in Win32/COM and SensorPortableDeviceValues in .NET. This container holds a collection of tuples, each of which is a Data Field PROPERTYKEY followed by the sensitivity value for that Data Field. The sensitivity always uses the same units of measure and data type as the matching Data Field.</p>
<pre class="brush: cpp">// Configure sensitivity
// create an IPortableDeviceValues container for holding the &lt;Data Field, Sensitivity&gt; tuples.
IPortableDeviceValues* pInSensitivityValues;
hr = ::CoCreateInstance(CLSID_PortableDeviceValues, NULL, CLSCTX_INPROC_SERVER, IID_PPV_ARGS(&amp;pInSensitivityValues));
if (FAILED(hr))
{
    ::MessageBox(NULL, _T("Unable to CoCreateInstance() a PortableDeviceValues collection."), _T("Sensor C++ Sample"), MB_OK | MB_ICONERROR);
    return -1;
}
// fill in IPortableDeviceValues container contents here: 0.1 G sensitivity in each of X, Y, and Z axes.
PROPVARIANT pv;
PropVariantInit(&amp;pv);
pv.vt = VT_R8; // COM type for (double)
pv.dblVal = (double)0.1;
pInSensitivityValues-&gt;SetValue(SENSOR_DATA_TYPE_ACCELERATION_X_G, &amp;pv);
pInSensitivityValues-&gt;SetValue(SENSOR_DATA_TYPE_ACCELERATION_Y_G, &amp;pv);
pInSensitivityValues-&gt;SetValue(SENSOR_DATA_TYPE_ACCELERATION_Z_G, &amp;pv);
// create an IPortableDeviceValues container for holding the &lt;SENSOR_PROPERTY_CHANGE_SENSITIVITY, pInSensitivityValues&gt; tuple.
IPortableDeviceValues* pInValues;
hr = ::CoCreateInstance(CLSID_PortableDeviceValues, NULL, CLSCTX_INPROC_SERVER, IID_PPV_ARGS(&amp;pInValues));
if (FAILED(hr))
{
    ::MessageBox(NULL, _T("Unable to CoCreateInstance() a PortableDeviceValues collection."), _T("Sensor C++ Sample"), MB_OK | MB_ICONERROR);
    return -1;
}
// fill it in
pInValues-&gt;SetIPortableDeviceValuesValue(SENSOR_PROPERTY_CHANGE_SENSITIVITY, pInSensitivityValues);
// now actually set the sensitivity
IPortableDeviceValues* pOutValues;
hr = pAls-&gt;SetProperties(pInValues, &amp;pOutValues);
if (FAILED(hr))
{
    ::MessageBox(NULL, _T("Unable to SetProperties() for Sensitivity."), _T("Sensor C++ Sample"), MB_OK | MB_ICONERROR);
    return -1;
}
// check to see if any of the setting requests failed
DWORD dwCount = 0;
hr = pOutValues-&gt;GetCount(&amp;dwCount);
if (FAILED(hr) || (dwCount &gt; 0))
{
    ::MessageBox(NULL, _T("Failed to set one-or-more Sensitivity values."), _T("Sensor C++ Sample"), MB_OK | MB_ICONERROR);
    return -1;
}
PropVariantClear(&amp;pv);
</pre>
<p><a name="requesting-permissions" id="requesting-permissions"></a></p>
<p><strong>Requesting permissions for Sensors</strong></p>
<p>The end user may consider the information provided by sensors to be sensitive, i.e., Personally Identifiable Information (PII). Data Fields such as the computer's location (e.g., latitude and longitude), could be used to track the user. Therefore, before use, Windows forces apps to get end-user permission to access the sensor. Use the State property of the sensor and the <em>RequestPermissions()</em> method of the SensorManager if needed.</p>
<p>The <em>RequestPermissions()</em> method takes an array of sensors as an argument, so you can ask for permission for more than one sensor at a time if you want. The C++/COM code is shown below. Note that you must provide an (ISensorCollection *) argument to <em>RequestPermissions()</em>.</p>
<pre class="brush: cpp">// Get the sensor's state
SensorState state = SENSOR_STATE_ERROR;
HRESULT hr = pSensor-&gt;GetState(&amp;state);
if (FAILED(hr))
{
    ::MessageBox(NULL, _T("Unable to get sensor state."), _T("Sensor C++ Sample"), MB_OK | MB_ICONERROR);
    return -1;
}
// Check for access permissions, request permission if necessary.
if (state == SENSOR_STATE_ACCESS_DENIED)
{
    // Make a SensorCollection with only the sensors we want to get permission to access.
    ISensorCollection *pSensorCollection = NULL;
    hr = ::CoCreateInstance(CLSID_SensorCollection, NULL, CLSCTX_INPROC_SERVER, IID_PPV_ARGS(&amp;pSensorCollection));
    if (FAILED(hr))
    {
        ::MessageBox(NULL, _T("Unable to CoCreateInstance() a SensorCollection."), 
            _T("Sensor C++ Sample"), MB_OK | MB_ICONERROR);
        return -1;
    }
    pSensorCollection-&gt;Clear();
    pSensorCollection-&gt;Add(pAls); // add 1 or more sensors to request permission for...
    // Have the SensorManager prompt the end-user for permission.
    hr = m_pSensorManager-&gt;RequestPermissions(NULL, pSensorCollection, TRUE);
    if (FAILED(hr))
    {
        ::MessageBox(NULL, _T("No permission to access sensors that we care about."), 
            _T("Sensor C++ Sample"), MB_OK | MB_ICONERROR);
        return -1;
    }
}
</pre>
<p><a name="sensor-data-update" id="sensor-data-update"></a></p>
<p><strong>Sensor Data Update</strong></p>
<p>Sensors report data by throwing an event called a DataUpdated event. The actual Data Fields are packaged inside a SensorDataReport, which is passed to any attached DataUpdated event handlers. Your app can obtain the SensorDataReport by hooking a callback handler to the sensor's DataUpdated event. The event occurs in a Windows Sensor Framework thread, which is a different thread than the message-pump thread used to update your app's GUI. Therefore, you will need to do a "hand-off" of the SensorDataReport from the event handler (Als_DataUpdate) to a separate handler (Als_UpdateGUI) that can execute on the context of the GUI thread. In .NET, such a handler is called a <strong>delegate</strong> function.</p>
<p>The example below shows preparation of the delegate function. In C++/COM, you must use the SetEventSink method to hook the callback. The callback cannot simply be a function; it must be an entire class that inherits from ISensorEvents and also implements IUnknown. The ISensorEvents interface must have callback function implementations for:</p>
<pre class="brush: cpp">STDMETHODIMP OnEvent(ISensor *pSensor, REFGUID eventID, IPortableDeviceValues *pEventData);
        STDMETHODIMP OnDataUpdated(ISensor *pSensor, ISensorDataReport *pNewData);
        STDMETHODIMP OnLeave(REFSENSOR_ID sensorID);
        STDMETHODIMP OnStateChanged(ISensor* pSensor, SensorState state);
// Hook the Sensor for any DataUpdated, Leave, or StateChanged events.
SensorEventSink* pSensorEventClass = new SensorEventSink();  // create C++ class instance
ISensorEvents* pSensorEvents = NULL;
// get the ISensorEvents COM interface pointer
HRESULT hr = pSensorEventClass-&gt;QueryInterface(IID_PPV_ARGS(&amp;pSensorEvents)); 
if (FAILED(hr))
{
    ::MessageBox(NULL, _T("Cannot query ISensorEvents interface for our callback class."), 
        _T("Sensor C++ Sample"), MB_OK | MB_ICONERROR);
    return -1;
}
hr = pSensor-&gt;SetEventSink(pSensorEvents); // hook COM interface of our class to Sensor eventer
if (FAILED(hr))
{
    ::MessageBox(NULL, _T("Cannot SetEventSink on the Sensor to our callback class."), 
        _T("Sensor C++ Sample"), MB_OK | MB_ICONERROR);
    return -1;
}
</pre>
<p><strong>Code: Set a COM Event Sink for the sensor</strong></p>
<p>The DataUpdated event handler receives the SensorDataReport (and the sensor that initiated the event) as arguments. It calls the Invoke() method of the form to post those items to the delegate function. The GUI thread runs the delegate function posted to its Invoke queue and passes the arguments to it. The delegate function casts the data type of the SensorDataReport to the expected subclass, gaining access to its Data Fields. The Data Fields are extracted using the <em>GetDataField()</em> method of the SensorDataReport object. Each of the Data Fields has to be typecast to their "expected"/"documented" data types (from the generic/polymorphic data type returned by the <em>GetDataField()</em> method). The app can then format and display the data in the GUI.</p>
<p>The OnDataUpdated event handler receives the SensorDataReport (and the sensor what initiated the event) as arguments. The Data Fields are extracted using the <em>GetSensorValue()</em> method of the SensorDataReport object. Each of the Data Fields needs to have their PROPVARIANT checked for their "expected"/"documented" data types. The app can then format and display the data in the GUI. It is not necessary to use the equivalent of a C# delegate. This is because all C++ GUI functions (such as ::SetWindowText() shown here) use Windows message-passing to post the GUI update to the GUI thread / message-loop (the WndProc of your main window or dialog box).</p>
<pre class="brush: cpp">STDMETHODIMP SensorEventSink::OnDataUpdated(ISensor *pSensor, ISensorDataReport *pNewData)
{
    HRESULT hr = S_OK;
    if ((NULL == pNewData) || (NULL == pSensor)) return E_INVALIDARG;
    float fLux = 0.0f;
    PROPVARIANT pv = {};
    hr = pNewData-&gt;GetSensorValue(SENSOR_DATA_TYPE_LIGHT_LEVEL_LUX, &amp;pv);
    if (SUCCEEDED(hr))
    {
        if (pv.vt == VT_R4) // make sure the PROPVARIANT holds a float as we expect
        {
            // Get the lux value.
            fLux = pv.fltVal;
            // Update the GUI
            wchar_t *pwszLabelText = (wchar_t *)malloc(64 * sizeof(wchar_t));
            swprintf_s(pwszLabelText, 64, L"Illuminance Lux: %.1f", fLux);
            BOOL bSuccess = ::SetWindowText(m_hwndLabel, (LPCWSTR)pwszLabelText);
            if (bSuccess == FALSE)
            {
                ::MessageBox(NULL, _T("Cannot SetWindowText on label control."), 
                    _T("Sensor C++ Sample"), MB_OK | MB_ICONERROR);
            }
            free(pwszLabelText);
        }
    }
    PropVariantClear(&amp;pv);
    return hr;
}
</pre>
<p>You can just reference properties of the SensorDataReport object to extract Data Fields from the SensorDataReport. This only works for the .NET API (in the Win32/COM API, you must use the GetDataField method), and for "well known" or "expected" Data Fields of that particular SensorDataReport subclass. It is possible (using something called "Dynamic Data Fields") for the underlying driver/firmware to "piggyback" any "extended/unexpected" Data Fields inside SensorDataReports. To extract those, you must use the GetDataField method.</p>
<p><a name="using-sensors-in-metro-style-apps" id="using-sensors-in-metro-style-apps"></a></p>
<h2>Using Sensors in Windows UI Apps</h2>
<p>Unlike the Desktop mode, Windows UI/WinRT Sensor API follows a common template for each of the sensors:</p>
<ul><li>There is usually a single event called <em>ReadingChanged</em> that calls the callback with an xxxReadingChangedEventArgs containing a Reading object holding the actual data. (the accelerometer is an exception; it also has a Shaken event).</li>
<li>The hardware-bound instance of the sensor class is retrieved using the <em>GetDefault()</em> method.</li>
<li>Polling can be done with the <em>GetCurrentReading()</em> method.</li>
</ul><p>Windows UI apps are typically written either in JavaScript or in C#. There are different language-bindings to the API, which result in a slightly different capitalization appearance in the API names and a slightly different way that events are handled. The simplified API is easier to use, and the pros and cons are listed in Table 5.</p>
<p align="center">Table 5: Sensor APIs for Windows UI Apps, pros and cons</p>
<table class="table-blue-themed-fixed-width"><thead><tr><th><strong>Feature</strong></th><th><strong>Pros</strong></th><th><strong>Cons</strong></th></tr></thead><tbody><tr><td>SensorManager</td>
<td>There is no SensorManager to deal with. Apps use the GetDefault() method to get an instance of the sensor class.</td>
<td>
<ul><li>It is not possible to search for arbitrary sensor instances. If more than one of a particular sensor type exists on a computer, you will only see the "first" one.</li>
<li>It is not possible to search for arbitrary sensor types or categories by GUID. Vendor value-add extensions are inaccessible.</li>
</ul></td>
</tr><tr><td>Events</td>
<td>Apps only worry about the DataUpdated event.</td>
<td>
<ul><li>Apps have no access to Enter, Leave, StatusChanged, or arbitrary event types. Vendor value-add extensions are inaccessible.</li>
</ul></td>
</tr><tr><td>Sensor properties</td>
<td>Apps only worry about the ReportInterval property.</td>
<td>
<ul><li>Apps have no access to the other properties, including the most useful one: Sensitivity.</li>
<li>Other than manipulating the ReportInterval property, there is no way for Windows UI apps to tune or control the flow rate of Data Reports.</li>
<li>Apps cannot access arbitrary Properties by PROPERTYKEY. Vendor value-add extensions are inaccessible.</li>
</ul></td>
</tr><tr><td>Data Report properties</td>
<td>Apps only worry about a few, pre-defined Data Fields unique to each sensor.</td>
<td>
<ul><li>Apps have no access to other Data Fields. If sensors "piggy-back" additional well-known Data Fields in a Data Report beyond what Windows UI apps expect, the Data Fields are inaccessible.</li>
<li>Apps cannot access arbitrary Data Fields by PROPERTYKEY. Vendor value-add extensions are inaccessible.</li>
<li>Apps have no way to query at run-time what Data Fields a sensor supports. It can only assume what the API pre-defines.</li>
</ul></td>
</tr></tbody></table><p><a name="summary" id="summary"></a></p>
<h2>Summary</h2>
<p>Windows 8 APIs provide developers an opportunity to take advantage of sensors available on different platforms under both the traditional Desktop mode and the new Windows UI app interface. In this document, we have presented an overview of the sensor APIs available to developers looking to create applications with Windows 8, focusing on the APIs and code samples for Desktop mode apps.</p>
<p><a name="appendix" id="appendix"></a></p>
<h2>Appendix</h2>
<p><a name="coordinate-system" id="coordinate-system"></a></p>
<p><strong>Coordinate System for Different Form Factors</strong></p>
<p>The Windows API reports X, Y, and Z axes in a manner that is compatible with the HTML5 standard (and Android). It is also called the "ENU" system because X faces virtual "<strong>E</strong>ast", Y faces virtual "<strong>N</strong>orth", and Z faces "<strong>U</strong>p".</p>
<p>To figure out the direction of rotation, use the "Right Hand Rule":</p>
<p>* Point the thumb of your right hand in the direction of one of the axes.</p>
<p>* Positive angle rotation around that axis will follow the curve of your fingers.</p>
<p><img src="45373-f-5.jpg" /></p>
<p>These are the X, Y, and Z axes for a tablet form-factor PC, or phone (left) and for a clamshell PC (right). For more esoteric form factors (for example, a clamshell that is convertible into a tablet), the .standard. orientation is when it is in the TABLET state.</p>
<p>If you intend to develop a navigation application (e.g., 3D space game), you need to convert from "ENU" systems in your program. This can be done easily using matrix multiplication. Graphics libraries such as Direct3D and OpenGL have APIs for handling this.</p>
<p><img src="45374-f-6.jpg" /></p>
<p><a name="resources" id="resources"></a></p>
<p><strong>Resources</strong></p>
<p>Win 7 Sensor API: <a href="http://msdn.microsoft.com/library/windows/desktop/dd318953(VS.85).aspx" target="_blank" rel="nofollow" onClick="recordOutboundLink(this, 'appup9-msdn3', 'appup9')">http://msdn.microsoft.com/library/windows/desktop/dd318953(VS.85).aspx</a></p>
<p>Sensor API Programming Guide: <a href="http://msdn.microsoft.com/en-us/library/dd318964(v=vs.85).aspx" target="_blank" rel="nofollow" onClick="recordOutboundLink(this, 'appup9-msdn4', 'appup9')">http://msdn.microsoft.com/en-us/library/dd318964(v=vs.85).aspx</a></p>
<p>Integrating Motion and Orientation Sensors: <a href="http://msdn.microsoft.com/en-us/library/windows/hardware/br259127.aspx" target="_blank" rel="nofollow" onClick="recordOutboundLink(this, 'appup9-msdn5', 'appup9')" >http://msdn.microsoft.com/en-us/library/windows/hardware/br259127.aspx</a></p>

<div id="footer" class="noprint">

<div id="social" style="margin-top:5px;height:23px;">
<table>
<tr>
<td> 
<div id="fb-root"></div>
<div id="fb-recommend" class="fb-like" data-send="false" data-width="120" data-height="21" data-layout="button_count" data-action="recommend"></div>
</td>
<td>
<a class="twitter-share-button" data-count="horizontal" data-via="alexallain"></a>
</td>
<td>
<div class="g-plusone" data-size="medium"></div>
</td>
</tr>
</table>
</div>

<div style="font-size:14px;padding:10px;margin-top:5px;margin-bottom:5px;">
<div style="width:400px;margin-top:5px">
<div style="float:left"><a href=http://www.cprogramming.com/c++book/?inl=ft-nhp><img src=http://www.cprogramming.com/c++book/small_3d.jpg border=0></a></div>Want to become a C++ programmer? The Cprogramming.com ebook, Jumping into C++, will walk you through it, step-by-step. <a href=http://www.cprogramming.com/c++book/?inl=ft-nhp>Get Jumping into C++ today!</a>
</div>
<div style="clear: both"></div>

<b>Popular pages</b>
<ul>
 <li><a href=http://www.cprogramming.com/begin.html>Exactly how to get started with C++ (or C) today</a> 
<li><a href=http://www.cprogramming.com/tutorial/c-tutorial.html>C Tutorial</a>
<li><a href=http://www.cprogramming.com/tutorial/c++-tutorial.html>C++ Tutorial</a>
<li><a href=http://www.cprogramming.com/how_to_learn_to_program.html>5 ways you can learn to program faster</a> 
<li><a href=http://www.cprogramming.com/beginner_programming_mistakes.html>The 5 Most Common Problems New Programmers Face</a>
<li><a href=http://www.cprogramming.com/code_blocks/>How to set up a compiler</a>
<li><a href=http://www.cprogramming.com/tutorial/common.html>8 Common programming Mistakes</a> 
<li><a href=http://www.cprogramming.com/c++11/what-is-c++0x.html>What is C++11?</a>
<li><a href=http://www.cprogramming.com/tutorial/game_programming/same_game_part1.html>How to make a game in 48 hours</a>
</ul>

<b>Recent additions</b> <a href="http://feeds2.feedburner.com/Cprogrammingcom" rel="alternate" type="application/rss+xml"><img src="http://www.feedburner.com/fb/images/pub/feed-icon16x16.png" alt="subscribe to a feed" style="border:0" width="16" height="16"></img></a>
<ul>
<li><a href=http://www.cprogramming.com/tutorial/shared-libraries-linux-gcc.html>How to create a shared library on Linux with GCC</a> - December 30, 2011</li>
<li> <a href="http://www.cprogramming.com/c++11/c++11-nullptr-strongly-typed-enum-class.html">Enum classes and nullptr in C++11</a> - November 27, 2011</li>
<li><a href="http://www.cprogramming.com/tutorial/computersciencetheory/hash-table.html">Learn about The Hash Table</a> - November 20, 2011</li>
<li><a href="http://www.cprogramming.com/c++11/rvalue-references-and-move-semantics-in-c++11.html">Rvalue References and Move Semantics in C++11</a> - November 13, 2011</li>
<li><a href="http://www.cprogramming.com/java/c-and-c++-for-java-programmers.html">C and C++ for Java Programmers</a> - November 5, 2011</li>
<li><a href="http://www.cprogramming.com/tutorial/c++-iostreams.html">A Gentle Introduction to C++ IO Streams</a> - October 10, 2011</li>
</ul>

</div>
<style type="text/css">
@import url(http://www.google.com/cse/api/branding.css);
</style>
<div class="cse-branding-bottom" style="background-color:#FFFFFF;color:#000000;width:50%; margin:auto">
  <div class="cse-branding-form">
    <form action="http://www.google.com/cse" id="cse-search-box">
      <div>
        <input type="hidden" name="cx" value="partner-pub-2560316224908115:0581759109" />
        <input type="hidden" name="ie" value="UTF-8" />
        <input type="text" name="q" size="55" />
        <input type="submit" name="sa" value="Search" />
      </div>
    </form>
  </div>
  <div class="cse-branding-logo">
    <img src="http://www.google.com/images/poweredby_transparent/poweredby_FFFFFF.gif" alt="Google" />
  </div>
  <div class="cse-branding-text">
    Custom Search
  </div>
</div>

<center>
<div style="margin-top:20px; margin-bottom: 20px">
<script type="text/javascript">
<!--
google_ad_client = "pub-2560316224908115";
/* link_ads_bottom */
google_ad_slot = "2258412831";
google_ad_width = 728;
google_ad_height = 15;
//-->
</script> 
<script type="text/javascript" src="http://pagead2.googlesyndication.com/pagead/show_ads.js"> </script> 
</div>
 
<script type="text/javascript" src="http://forms.aweber.com/form/12/618210012.js"></script>

<div class="footer-links" style="padding:10px">
<a href="http://www.cprogramming.com/advertising.html">Advertising</a> | <a href="http://www.cprogramming.com/privacy.html">Privacy policy</a> |
<a href="http://www.cprogramming.com/use.html">Copyright © 1997-2011 Cprogramming.com. All rights reserved.</a> | <a href=mailto:webmaster@cprogramming.com>webmaster@cprogramming.com</a>
</div>
</div>
</div>
</td>
    	


<td class="content noprint" valign="top" rowspan="1" bgcolor="#EBEBEB">
<div class="content2"><br><div class="verticalad">







<script type="text/javascript"><!--
        e9 = new Object();
    e9.size = "160x600,120x600";
//--></script>
<script type="text/javascript" src="http://tags.expo9.exponential.com/tags/Cprogrammingcom/ROS/tags.js"></script>



</div><br>

<style type="text/css">
.sidebar-box { width: 150px; margin-bottom:5px; }
</style>
    <div id="side-images">
        <div style="padding:5px;margin-top:5px">
            <div style="margin-bottom: 5px">
                <b>Popular pages</b>
            </div>
            <div>
                
                <!--http://www.flickr.com/photos/baslow/5620208/sizes/o/in/photostream/ -->
                <div class = "sidebar-box">
                    <a href=http://www.cprogramming.com/tutorial/c-tutorial.html>
                    <img src=http://static.cprogramming.com/main_images/footer/5620208_bff9c514e6_s.jpg border=0 height=75 width=75 alt="C tutorial">
                    <br>
                    C Tutorial
                    </a>
                </div>
                

                
                <!--http://www.flickr.com/photos/29233640@N07/2855530649/sizes/sq/in/photostream/-->
                <div class = "sidebar-box">
                    <a href=http://www.cprogramming.com/begin.html>
                    <img src=http://static.cprogramming.com/main_images/footer/2855530649_905f7862fd_s.jpg border=0 height=75 width=75 alt="Get started">
                    <br>
                    Exactly how to get started with C++ (or C) today</a>
                </div>
                

                
                <!--http://www.flickr.com/photos/mikecogh/6505012533/sizes/sq/in/photostream/-->
                <div class = "sidebar-box">
                    <a href=http://www.cprogramming.com/how_to_learn_to_program.html>
                    <img src=http://static.cprogramming.com/main_images/footer/6505012533_55c83fdfa0_s.jpg border=0 height=75 width=75 alt="Learn to program">
                    <br>
                    5 ways you can learn to program faster</a>
                </div>
                

                
                <div class = "sidebar-box">
                    <a href=http://www.cprogramming.com/tutorial/c++-tutorial.html>
                    <img src=http://static.cprogramming.com/main_images/footer/c++-img.png border=0 height=75 width=75 alt="C++ tutorial">
                    <br>
                    C++ Tutorial</a>
                </div>
                

                
                <!--http://www.flickr.com/photos/giopuo/3441263816/sizes/sq/in/photostream/-->
                <div class = "sidebar-box">
                    <a href=http://www.cprogramming.com/beginner_programming_mistakes.html>
                    <img src=http://static.cprogramming.com/main_images/footer/3441263816_95f132a884_s.jpg border=0 height=75 width=75 alt="Problems new programmers face">
                    <br>
                    The 5 Most Common Problems New Programmers Face</a>
                </div>
                

                
                <div class = "sidebar-box">
                   <a href=http://www.cprogramming.com/tutorial/game_programming/same_game_part1.html>
                    <img src=http://www.cprogramming.com/tutorial/game_programming/same_game_small.png border=0 height=42 width=42 alt="Learn to make a game">
                    <br>
                   How to make a game in 48 hours</a>
                </div>
                

                
                <div class = "sidebar-box">
                   <a href=http://www.cprogramming.com/tutorial/common.html>
                    <img src=http://static.cprogramming.com/main_images/footer/2291127824_087a497bea_s.jpg border=0 height=75 width=75 alt="Common problems">
                    <br>
                   8 Common Programming Mistakes</a>
                </div>
                

                
                <div class = "sidebar-box">
                   <a href=http://www.cprogramming.com/c++11/what-is-c++0x.html>
                    <img src=http://static.cprogramming.com/main_images/footer/c++11.png border=0 height=75 width=75 alt="C++11">
                    <br>
                   What is C++11?</a>
                </div>
                
            </div>
        </div>
        <div style="display:block">
            <a href=/image_credits.html>Image credits</a>
        </div>
    </div>
</div>
</td>  	

</tr>
</table>
</div>


<script>
(function(w, d, s) {
  var cur_url = window.location;
  var loc = cur_url;
  if ( /htm(l?)/.test( cur_url.pathname ) ) {
    loc = cur_url.protocol + "//" + cur_url.host + cur_url.pathname.replace( /\+/g, "%2b" );
  }
  d.getElementById( "fb-recommend" ).setAttribute( "data-href", loc );
  function go(){
    var js, fjs = d.getElementsByTagName(s)[0], load = function(url, id) {
          if (d.getElementById(id)) {return;}
          js = d.createElement(s); js.src = url; js.id = id;
          fjs.parentNode.insertBefore(js, fjs);
        };
    load('//connect.facebook.net/en_US/all.js#xfbml=1&channelUrl=http%3A%2F%2Fwww.cprogramming.com%2Ffb%2Fchannel.html', 'fbjssdk');
    load('https://apis.google.com/js/plusone.js', 'gplus1js');
    load('//platform.twitter.com/widgets.js', 'tweetjs');
  }
  if (w.addEventListener) { w.addEventListener("load", go, false); }
  else if (w.attachEvent) { w.attachEvent("onload",go); }
}(window, document, 'script'));
</script>


</body>
</html>

<script type="text/javascript" src="http://static.cprogramming.com/syntax-highlight/scripts/shCore.js"></script>
<script type="text/javascript" src="http://static.cprogramming.com/syntax-highlight/scripts/shBrushCpp.js"></script>
<script type="text/javascript">
         SyntaxHighlighter.all();
</script>



